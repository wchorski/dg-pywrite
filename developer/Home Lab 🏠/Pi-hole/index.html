<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Pi-hole</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://fastly.jsdelivr.net/npm/mermaid@9.4.0/dist/mermaid.min.js"></script>
<script>
    mermaid.initialize({
        startOnLoad: true,
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-sv0slik/5O0JIPdLBCR2A3XDg/1U3WuDEheZfI/DI5n8Yqc3h5kjrnr46FGBNiUAJF7rE4LHKwQ/SoSLRKAxEA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdn.jsdelivr.net/npm/lucide@0.115.0/dist/umd/lucide.min.js"></script>
<script>
    // Create callout icons
    window.addEventListener("load", () => {
        document.querySelectorAll(".callout").forEach((elem) => {
            const icon = getComputedStyle(elem).getPropertyValue('--callout-icon');
            const iconName = icon && icon.trim().replace(/^lucide-/, "");

            if (iconName) {
                const calloutTitle = elem.querySelector(".callout-title");

                if (calloutTitle) {
                    const calloutIconContainer = document.createElement("div");
                    const calloutIcon = document.createElement("i");

                    calloutIconContainer.appendChild(calloutIcon);
                    calloutIcon.setAttribute("icon-name", iconName);
                    calloutIconContainer.setAttribute("class", "callout-icon");
                    calloutTitle.insertBefore(calloutIconContainer, calloutTitle.firstChild);
                }
            }
        });

        lucide.createIcons();

        // Collapse callouts
        Array.from(document.querySelectorAll(".callout.is-collapsible")).forEach((elem) => {
            elem.querySelector('.callout-title').addEventListener("click", (event) => {
                if (elem.classList.contains("is-collapsed")) {
                    elem.classList.remove("is-collapsed");
                } else {
                    elem.classList.add("is-collapsed");
                }
            });
        });
    });
</script>


<script src="https://fastly.jsdelivr.net/npm/force-graph@1.43.0/dist/force-graph.min.js"></script>

<script defer src="https://fastly.jsdelivr.net/npm/@alpinejs/persist@3.11.1/dist/cdn.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/alpinejs@3.11.1/dist/cdn.min.js" defer></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
<script src="https://fastly.jsdelivr.net/npm/whatwg-fetch@3.6.2/dist/fetch.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<link href="/styles/digital-garden-base.css" rel="stylesheet">
    <link href="/styles/obsidian-base.css" rel="stylesheet">
    <link href="/styles/_theme.8f1d066a.css" rel="stylesheet">


<link href="/styles/custom-style.css" rel="stylesheet"><link href="/styles/user/pywrite.css" rel="stylesheet">
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">





<style></style>
    
      <script async src="https://soup.tawtaw.site/ramen" data-website-id="fa4f8c5b-4767-4821-b063-f62c4cb90223"></script>
    
    
  </head>
  <body class="theme-dark markdown-preview-view markdown-rendered markdown-preview-section ">
    
    
    
      
    <nav class="navbar">
        <div class="navbar-inner">
            <a href="/" style="text-decoration: none;">
                <h1 style="margin: 15px !important;">Digital Garden</h1>
            </a>
        </div>
        
    </nav>
    
    

    

    <main class="content cm-s-obsidian ">
      <header>
        
        <div class="header-meta">
          </div>
      
      
      </header>
      
      
      <div class="callout " data-callout="info"><div class="callout-title"><div class="callout-title-inner"> <a href="https://pi-hole.net/" target="_blank" class="external-link">Pi-hole ‚Äì Network-wide protection</a><br></div></div>
<div class="callout-content">
<p>
Network-wide Ad Blocking</p>
</div></div>
<h2 id="install" tabindex="-1">install</h2>
<p>thanks to <a href="https://www.patreon.com/CraftComputing" target="_blank" class="external-link">Craft Computing</a> for putting together a easy to follow tutorial for setting up Pi-hole with Unbound DNS for extra privacy<br>
<a href="https://www.youtube.com/watch?v=FnFtWsZ8IP0&amp;t=551s" target="_blank" class="external-link">You're running Pi-Hole wrong! Setting up your own Recursive DNS Server! - YouTube</a></p>
<div class="callout " data-callout="important" data-callout-metadata=" "><div class="callout-title"><div class="callout-title-inner">Important</div></div>
<div class="callout-content">
<p>
don't forget to set boot option to wait for network (i.e. <code>raspi-config</code>)</p>
</div></div>
<h2 id="update-script-with-logging" tabindex="-1">Update script with Logging</h2>
<pre><code class="language-bash">#! /bin/bash

DATE=`date +%Y-%m-%d`
LOG=&quot;./update.log&quot;
echo $DATE &gt; $LOG

echo &quot;[ pihole -up ]&quot; &gt;&gt; $LOG
pihole -up         &gt;&gt; $LOG
echo &quot;=============&quot; &gt;&gt; $LOG

echo &quot;[ apt update ]&quot; &gt;&gt; $LOG
apt-get update      &gt;&gt; $LOG
echo &quot;============&quot; &gt;&gt; $LOG

echo &quot;[ apt upgrade ]&quot; &gt;&gt; $LOG
apt-get upgrade -y  &gt;&gt; $LOG
echo &quot;============&quot; &gt;&gt; $LOG
</code></pre>
<h2 id="backup" tabindex="-1">backup</h2>
<p>also a backup of <a class="internal-link" target="" data-note-icon="" href="/developer/Home Lab üè†/PiVPN/">developer/Home Lab üè†/PiVPN</a></p>
<pre><code class="language-bash">#! /bin/bash

DATE=`date +%Y-%m-%d`

echo '======================' &gt; backup.log
echo $DATE &gt;&gt; backup.log


if pihole -a -t\
&amp;&amp; mv /home/pi4/scripts/backup/pi-hole-rpi-teleporter* /home/pi4/scripts/backup/pihole\
; then
        echo 'pihole SUCCESS' &gt;&gt; backup.log
else
        echo 'pihole failed' &gt;&gt; backup.log
fi


if pivpn -bk\
&amp;&amp; sudo mv /home/pi4/pivpnbackup/* /home/pi4/scripts/backup/pivpn\
; then
        echo 'pivpn SUCCESS' &gt;&gt; backup.log
else
        echo 'pivpn failed' &gt;&gt; backup.log
fi
</code></pre>
<h2 id="resolve-dns-for-the-raspberry-pi" tabindex="-1">Resolve DNS for the Raspberry PI</h2>
<p>Try to ssh into Raspberry Pi (or whatever you host <strong>Pi-Hole</strong> on) and try to ping any local DNS entries (that you would have set up in <a class="internal-link is-unresolved" href="/404" target="">PiVPN</a>). These are not reachable because the Pi itself is not resolving to the local domain name service because it is higher up the stream. We can manually tell the pi to resolve itself (assuming Pi-hole and PiVPN are running on the same machine).</p>
<pre><code class="language-shell">sudo nano /etc/dhcpcd.conf
</code></pre>
<p>find the line and add <code>127.0.0.1</code> and save.</p>
<pre><code class="language-shell">static domain_name_servers=127.0.0.1
</code></pre>
<pre><code class="language-shell">sudo service dhcpcd restart
</code></pre>
<h2 id="credits" tabindex="-1">Credits</h2>
<ul>
<li><a href="https://pimylifeup.com/raspberry-pi-dns-settings/" target="_blank" class="external-link">Raspberry Pi DNS Settings: How to Change the DNS - Pi My Life Up</a></li>
<li><a href="https://discourse.pi-hole.net/t/pi-holes-host-machine-cant-resolve-local-domains/48008" target="_blank" class="external-link">Pi-hole's host machine can't resolve local domains - Help / Community Help - Pi-hole Userspace</a></li>
</ul>

      
      
    </main>

    

    
        <script>
      if (window.location.hash) {
        document.getElementById(window.location.hash.slice(1)).classList.add('referred');
      }
      window.addEventListener('hashchange', (evt) => {
        const oldParts = evt.oldURL.split("#");
        if (oldParts[1]) {
          document.getElementById(oldParts[1]).classList.remove('referred');
        }
        const newParts = evt.newURL.split("#");
        if (newParts[1]) {
          document.getElementById(newParts[1]).classList.add('referred');
        }
      }, false);
      const url_parts = window.location.href.split("#")
      const url = url_parts[0];
      const referrence = url_parts[1];
      document.querySelectorAll(".cm-s-obsidian > *[id]").forEach(function (el) {
        el.ondblclick = function(evt) {
          const ref_url = url + '#' + evt.target.id
          navigator.clipboard.writeText(ref_url);
      }
      });

      
    </script>
    <script src=" https://fastly.jsdelivr.net/npm/luxon@3.2.1/build/global/luxon.min.js "></script>
<script defer>
    TIMESTAMP_FORMAT = "MMM dd, yyyy h:mm a";
    document.querySelectorAll('.human-date').forEach(function (el) {
        el.innerHTML = luxon.DateTime.fromISO(el.getAttribute('data-date') || el.innerText).toFormat(TIMESTAMP_FORMAT);
      });
</script>
    
    
    <script>
lucide.createIcons({
            attrs: {
                class: ["svg-icon"]
            }
        });
</script>
  </body>
</html>
