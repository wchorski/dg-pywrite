<p>Needed to batch edit the #frontmatter of my markdown files for my [[developer/Home Lab üè†/Obsidian.md|developer/Home Lab üè†/Obsidian.md]] vault.</p>
<p>This script checks if the first line is <code>---</code> (i.e. the start of frontmatter) and decides if we just add the <code>dg-publish: true</code> or do we need a whole frontmatter block</p>
<pre><code class="language-yml">---
dg-publish: true
---
</code></pre>
<pre><code class="language-bash">#!/bin/bash

cd /home/icicle/scripts/test-md

for file in ./*.md; do

  FIRSTLINE=$(head -n 1  &quot;$file&quot;)
  SECONDLINE=$(sed -n '2p' &quot;$file&quot;)

  ## check if frontmatter already exists
  if [ &quot;$FIRSTLINE&quot; = &quot;---&quot; ]; then

    ## see if &quot;dg-publish: true is already 2nd line&quot;
    if [ &quot;$SECONDLINE&quot; = 'dg-publish: true' ]; then
      echo &quot;Already PUBLISHED: $file&quot;
    else
      sed -i '2i\dg-publish: true' &quot;$file&quot;
    fi
  else
    # add a frontmatter block
    sed -i '1s/^/---\ndg-publish: true\n---\n/' &quot;$file&quot;
  fi

done
</code></pre>
<hr>
<h2 id="credits" tabindex="-1">Credits</h2>
<ul>
<li><a href="https://unix.stackexchange.com/questions/270085/using-sed-to-modify-all-files-in-a-directory-and-name-the-outputs-accordingly" target="_blank" class="external-link">bash - using sed to modify all files in a directory and name the outputs accordingly - Unix &amp; Linux Stack Exchange</a></li>
<li><a href="https://stackoverflow.com/questions/2439579/how-to-get-the-first-line-of-a-file-in-a-bash-script" target="_blank" class="external-link">How to get the first line of a file in a bash script? - Stack Overflow</a></li>
<li><a href="https://stackoverflow.com/questions/10523415/execute-command-on-all-files-in-a-directory" target="_blank" class="external-link">bash - Execute command on all files in a directory - Stack Overflow</a></li>
<li><a href="https://stackoverflow.com/questions/20235217/syntax-error-near-unexpected-token-then" target="_blank" class="external-link">linux - Syntax error near unexpected token 'then' - Stack Overflow</a></li>
<li><a href="https://stackoverflow.com/questions/45483844/how-to-insert-a-string-into-second-to-last-line-of-a-file" target="_blank" class="external-link">bash - How to insert a string into second to last line of a file - Stack Overflow</a></li>
</ul>
