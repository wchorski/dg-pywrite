<p>Monitor your websites in bulk by using <code>curl</code> on the page and returning the status code</p>
<ul>
<li><code>200</code> - good</li>
<li><code>302</code> - good redirect</li>
<li><code>500</code> - server side error</li>
<li><code>000</code> - website or DNS is down</li>
</ul>
<pre><code class="language-bash">#!/bin/bash

cd ~/html-status-codes

declare -a WEBSITES
WEBSITES+=( 
  &quot;https://make-a-gram.williamusic.com&quot;
  &quot;https://www.tawtaw.site/home&quot;
  &quot;https://cutefruit.tawtaw.site/home&quot; 
  &quot;https://partyvibeonline.tawtaw.site/home&quot;
  &quot;http://prowlarr.lan&quot;
  &quot;http://dupdash.lan&quot;
  &quot;https://150events-ks.tawtaw.site/home&quot;
  &quot;https://blesspress.williamusic.com&quot;
)

# commented code is for monitoring in a single document
# printf '%(%Y-%m-%d %H:%M:%S)T\n' -1 &gt;&gt; all-codes.log

for website in &quot;${WEBSITES[@]}&quot;
do
  # curl -o /dev/null -s -w &quot;%{http_code} &quot; $website &gt;&gt; all-codes.log
  # echo &quot;$website&quot; &gt;&gt; all-codes.log

  # remove any bad chars for filenames
  FILENAME=$(sed -E 's/(http|https):\/\///g' &lt;&lt;&lt; $website | sed 's/\//_/g')
  test -e &quot;./logs/$FILENAME.log&quot; || touch ./logs/$FILENAME.log
  curl -o /dev/null -s -w &quot;%{http_code}&quot; $website &gt; &quot;./logs/$FILENAME.log&quot;
done

# echo &quot;---&quot; &gt;&gt; all-codes.log
</code></pre>
<p>This will create a file for each website that houses the latest code returned. If you want a single file that houses the log with timestamp, uncomment out the other snippets.</p>
<h2 id="cron" tabindex="-1">Cron</h2>
<p>Run this regularly with a <code>crontab -e</code> config every 15 minutes</p>
<pre><code class="language-shell">*/15 * * * * ~/html-status-codes/html-code-monitor.sh
</code></pre>
<h2 id="home-assistant-sensor" tabindex="-1">Home Assistant Sensor</h2>
<p>I leverage [[developer/Home Lab üè†/Home Assistant|developer/Home Lab üè†/Home Assistant]] as a way to track history and send alerts. Here is how to set up the sensor</p>
<pre><code class="language-yml">sensor:
	- platform: template
	  sensors:
	    html_code_makeagram:
	      friendly_name: HTML Code Make a Gram
	      value_template: &quot;{{ int(value,0)}}&quot;
	      icon_template: &gt;-
	        {% if int(value,0) == 0 %}
	          mdi:server-off
	        {% elif int(value,0) &gt; 199 and int(value,0) &lt; 400 %}
	          mdi:check-circle
	        {% elif int(value,0) &gt; 499 %}
	          mdi:alert-outline
	        {% else %}
	          mdi:help-rhombus-outline
	        {% endif %}
</code></pre>
<h2 id="credit" tabindex="-1">Credit</h2>
<ul>
<li>
<p>[[<a href="http://home-assistant.io" target="_blank" class="external-link">home-assistant.io</a>)](<a href="https://community.home-assistant.io/t/creating-template-sensor/273724%5C%7CCreating" target="_blank" class="external-link">https://community.home-assistant.io/t/creating-template-sensor/273724\|Creating</a> Template Sensor - Configuration - Home Assistant Community (<a href="http://home-assistant.io" target="_blank" class="external-link">home-assistant.io</a>)]]</p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/6852951/use-sed-to-replace-all-backslashes-with-forward-slashes" target="_blank" class="external-link">https://stackoverflow.com/questions/6852951/use-sed-to-replace-all-backslashes-with-forward-slashes</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/4014074/how-to-read-output-of-sed-into-a-variable" target="_blank" class="external-link">https://stackoverflow.com/questions/4014074/how-to-read-output-of-sed-into-a-variable</a></p>
</li>
<li>
<p><a href="https://www.unix.com/shell-programming-and-scripting/66986-if-file-not-exist-create-new-one.html" target="_blank" class="external-link">https://www.unix.com/shell-programming-and-scripting/66986-if-file-not-exist-create-new-one.html</a></p>
</li>
<li>
<p>[[developer/Linux/Linux|developer/Linux/Linux]]</p>
</li>
<li>
<p>[[developer/_developer_boxüì¶|developer/_developer_boxüì¶]]</p>
</li>
</ul>
