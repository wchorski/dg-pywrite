<p>Most tutorials dealing with the <a href="https://developers.google.com/calendar/api/quickstart/nodejs" target="_blank" class="external-link">Google Calendar API</a> deal with your users loggin in to add the created event to their personal calendars. In my case I have employees that I want to create/ update calendars events for a single <em>main</em> calendar, without having any login. Authorization is already set up and calendar is pointed during development</p>
<h2 id="lightbulb-moment" tabindex="-1">Lightbulb Moment</h2>
<p>I was still struggling on how the flow of information happens since most of the data is moved in a Headless environment. [[<a href="https://zappysys.com/api/integration-hub/google-calendar-connector/help/authentication/ServiceAccount#:~:text=Copy" target="_blank" class="external-link">https://zappysys.com/api/integration-hub/google-calendar-connector/help/authentication/ServiceAccount#:~:text=Copy</a> the email address of your service account,On the left%2C find the &quot;My calendars&quot; section.|<a href="https://zappysys.com/api/integration-hub/google-calendar-connector/help/authentication/ServiceAccount#:~:text=Copy" target="_blank" class="external-link">https://zappysys.com/api/integration-hub/google-calendar-connector/help/authentication/ServiceAccount#:~:text=Copy</a> the email address of your service account,On the left%2C find the &quot;My calendars&quot; section.]] helped me understand how to set it up. Here is the bullet points.</p>
<p>(this assumes you've already set up the project &amp; Calendar APIs via the google console)</p>
<ul>
<li>Log into your Google Account you conduct regular buisness <code>MYBUISNESS@gmail.com</code></li>
<li>Create (or view an existing email)</li>
<li>Go to share settings of selected calendar</li>
<li>Add the generated <strong>Service Account</strong> email (will look something like <code>MYBUISNESS-project.iam.gserviceaccount.com</code>)</li>
<li>Make sure permissions are set correctly (in my case I set it to &quot;Make changes and manage sharing&quot;)</li>
<li>On the same page, copy the calendar  (example: <code>bda948b786f16be2d763e0b2d3c699bc8230643f96bfbfb2at64b66e7fc92b11@group.calendar.google.com</code>)</li>
</ul>
<h2 id="next-js-api-route" tabindex="-1">NextJS API Route</h2>
<p>I'm wrapping the google api in a #NextJS API route so that everything happens on the server</p>
<p><code>/pages/api/google/create.ts</code></p>
<pre><code class="language-ts">import type { NextApiRequest, NextApiResponse } from 'next'

import { google } from 'googleapis';
import { JWT } from 'google-auth-library';
import creds from &quot;../../../private/cutefruit-project.json&quot;;

const scopes = ['https://www.googleapis.com/auth/calendar'];
const GOOGLE_PRIVATE_KEY = creds.private_key|| 'NO_KEY_SET'
const GOOGLE_CLIENT_EMAIL = creds.client_email || 'NO_EMAIL_SET'
const GOOGLE_CAL_ID = process.env.GOOGLE_CAL_ID || 'primary'


let jwtClient = new JWT({
  email: GOOGLE_CLIENT_EMAIL,
  key: GOOGLE_PRIVATE_KEY,
  scopes,
})

jwtClient.authorize(function (err, tokens) {
  if (err) {
    console.log(err);
    return
  } else {
    console.log(&quot;Successfully connected to googleapi via JWT!&quot;)
  }
})

type Data = {
  id: string|undefined|null,
  htmlLink: string|undefined|null,
  kind: string|undefined|null,
  status: string|undefined|null,
  message: any,
}


export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse&lt;Data&gt;
) {
  // console.log(req.method)
  if(req.method === 'POST'){
    const event = req.body
    // console.log({event})
    
    let calendar = google.calendar('v3')
    
    try {
      const response = await calendar.events.insert({
        auth: jwtClient,
        calendarId: GOOGLE_CAL_ID,
        requestBody: event,
      })
      res.status(response.status).json({ 
        id: response.data.id,
        htmlLink: response.data.htmlLink, 
        kind: response.data.kind,
        status: response.data.status,
        message: response.statusText, 
      })
      
    } catch (err:any) {
      console.log('Google Cal API Error: ' + err)

      res.status(201).json({ 
        id: undefined,
        htmlLink: undefined, 
        kind: undefined,
        status: undefined,
        message: err.errors.map((err:any) =&gt;  err.message).join(', ') 
      })
    }
    

    // res.status(200).json({ message: 'default response' })
  }
}

</code></pre>
<h2 id="usage" tabindex="-1">Usage</h2>
<p>with this snippet you can retrieve anything created in this calendar</p>
<pre><code class="language-ts">calendar.events.list({
		auth: jwtClient,
		calendarId: GOOGLE_CAL_ID
	}, function (err, response) {

		if(response) {
			console.log('----- here is a list of events in this calendar ---- ');
			
			return console.log(response.data.items)
		};
		if(err) return console.log(err);
		
	})
</code></pre>
